using System;
using System.Collections;
using UnityEngine;

public class CharacterInvulnerability:MonoBehaviour
{
    [SerializeField] private float invulnerabilityTime = 3;
    [SerializeField] private int invulnerableTo;

    public event Action OnInvulnerabilityEnd;

    private Coroutine timerToEnd;

    public void EnableInvulnerability()
    {
        Physics.IgnoreLayerCollision(gameObject.layer, invulnerableTo, true);

        timerToEnd = StartCoroutine(TimerToEnd());
    }

    public void DisableInvulnerability()
    {
        if (timerToEnd != null)
        {
            StopCoroutine(timerToEnd);
            Physics.IgnoreLayerCollision(gameObject.layer, invulnerableTo, false);
            OnInvulnerabilityEnd?.Invoke();
            timerToEnd = null;
        }

    }

    private IEnumerator TimerToEnd()
    {
        yield return new WaitForSeconds(invulnerabilityTime);
        DisableInvulnerability();
    }
}

